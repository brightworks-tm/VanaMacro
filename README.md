# VanaMacro

Final Fantasy XI のマクロを PC 上で編集・管理するツールです。

## 特徴

- FFXI のマクロをPCで快適に編集
- 40 Book × 10 Set × 20 マクロを一覧管理
- シンタックスハイライト、コマンド補完
- 定型文（オートトランスレート）の検索・挿入
- 日本語 / 英語 UI 対応

## 起動方法

**`VanaMacro.vbs`** をダブルクリックしてください（管理者権限で起動します）。

## 基本的な使い方

### 1. FFXIからマクロを取り込む

初回起動時、ツールバーの **「FFXIから取り込み」** ボタンを押してください。
FFXI のマクロデータが読み込まれます。

### 2. マクロを編集する

- 左側で **Book** を選択
- 上部で **Set** を選択（Set 1〜10）
- **Ctrl/Alt** ボタンでマクロスロットを切り替え
- 6行のテキストエリアで編集

編集が終わったら **「マクロ保存」** ボタンを押してください。

### 3. FFXIへ反映する

1. **FFXIを完全に終了**（POL/FFXI両方を閉じる）
2. メニュー「ファイル」→「エクスポートセンター」
3. **「エクスポート実行」** → **「FFXI USERフォルダへコピー」**
4. FFXIを起動してログイン

## 便利な機能

### 入力補助
- `/` または `<` を入力するとコマンド/ターゲット候補が表示されます
- **Ctrl+Space** でも補完リストを呼び出せます

### 定型文リスト
- **Ctrl+T** で定型文リストを開きます
- ひらがな、カタカナ、ローマ字、漢字で検索できます
- 例: 「うつせみ」→「空蝉の術」がヒット

### テーマ切り替え
- メニュー「表示」から **Base / Dark / Game** テーマを選択できます

### 言語切り替え
- メニュー「ツール」→「言語設定...」で日本語 / 英語を切り替えられます
- マクロ内の定型文も自動変換できます

## キーボードショートカット

| ショートカット | 機能 |
|---------------|------|
| Ctrl+I | FFXIから取り込み |
| Ctrl+E | エクスポートセンター |
| Ctrl+S | マクロを保存 |
| Ctrl+T | 定型文リスト |
| Ctrl+Shift+C | マクロをコピー |
| Ctrl+Shift+V | マクロをペースト |
| Ctrl+Shift+D | マクロをクリア |
| Ctrl+0 | レイアウトをリセット |
| Ctrl+Q | 終了 |

## 注意事項

### マクロの反映タイミング

FFXIはログイン時にマクロをメモリに読み込み、ログアウト時にファイルへ書き戻します。
**FFXI起動中にコピーしても、ログアウト時に上書きされて消えてしまいます。**

マクロを反映するには：
1. **FFXIを完全に終了**（POL/FFXI両方を閉じる）
2. VanaMacroで**エクスポート＆コピー**
3. FFXIを起動してログイン

### Book名について

VanaMacro は Book名も正しく書き出します。
ただし、**FFXI起動中にコピーすると、Book名がすべて白紙になってしまう**場合があります。
Book名を反映させるには、必ず **FFXIを完全に終了** してからエクスポートしてください。

### Set名について

Set名はツール内の整理用ラベルです（FFXIには反映されません）。

### データの安全性

「FFXIから取り込み」を実行すると、実行直前に自動でバックアップが作成されます。
万が一の際は `data/export/` から復元できます。

## スクリーンショット

| ライトモード | ダークモード |
|:---:|:---:|
| ![ライトモード](docs/screenshots/main_window_light.png) | ![ダークモード](docs/screenshots/main_window_dark.png) |

## 動作環境

- Windows
- Python 3.13 以降
- PyQt6、pykakasi

## 利用上の注意

本ツールは個人の趣味の範囲での利用を前提としています。
以下の行為はご遠慮ください：

- 本ツール（修正版を含む）の転売・有償配布
- 有料ツールパッケージへの同梱
- その他、営利を目的とした利用

利用者は自己の責任において本ツールを使用するものとします。

---

[![ko-fi](https://ko-fi.com/img/githubbutton_sm.svg)](https://ko-fi.com/brightworks_tm)
